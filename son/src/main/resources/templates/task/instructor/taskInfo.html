<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{common/layouts/instructorDetailSubject_layout}"
	layout:fragment="content">
<head>

<title>과제 상세 조회</title>

<!-- Include ConfigFragment -->
<script src="https://cdn.tailwindcss.com"></script>
<script th:inline="javascript">let lectureNumber = /* [[${lectureNumber}]] */ "";</script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
        #taskInfoBody {
            font-family: 'Roboto', sans-serif;
        }
</style>
</head>

<body id="taskInfoBody">
			
			
	<div id="container" style="width: 896px; margin: 0 auto;">
    <div class="max-w-4xl mx-auto bg-white shadow-md rounded-lg overflow-hidden">
        <div class="grid grid-cols-4 gap-4 p-6 border-b">
            <div class="col-span-1 font-bold">제목</div>
            <div class="col-span-3 border-gray-300" th:text="${taskInfo.title}"></div>
        </div>
        <div class="grid grid-cols-4 gap-4 p-6 border-b">
            <div class="col-span-1 font-bold">게시일자</div>
            <div class="col-span-1  border-gray-300" th:text="${#dates.format(taskInfo.postDate, 'yyyy년 MM월 dd일')}"></div>
            <div class="col-span-1 font-bold">제출기한</div>
            <div class="col-span-1  border-gray-300" th:text="${#dates.format(taskInfo.submitDeadline, 'yyyy년 MM월 dd일')}"></div>
        </div>
        <div class="grid grid-cols-4 gap-4 p-6">
            <div class="col-span-1 font-bold mb-2">내용</div>
            <div class="col-span-1  border-gray-300" th:text="${taskInfo.description}">
			</div>
        </div>
		<div class="grid grid-cols-4 p-6 border-b">
		    <div class="col-span-1 font-bold mb-2">첨부 파일</div>
		    <div class="col-span-3 border-gray-300" id="files">
		        
		            <th:block th:each="file : ${taskInfo.fileList}">
		                <p th:if="${file.isDeleted} == false">
		                    <a th:href="@{/instructor/taskInfo/{taskNumber}/files/{attachmentFileNumber}/download(taskNumber=${taskInfo.taskNumber},attachmentFileNumber=${file.attachmentFileNumber})}">
		                    <span class="icons"><i class="fas fa-folder-open"></i></span>
		                    <span th:text="${file.originalFileName}"> <span class="icons"><i class="fas fa-folder-open"></i></span></span></a>
		                </p>
		        </th:block>
		    </div>
		</div>
    </div>
        <div class="btn-group float-end" role="group">
        	<button type="button" class="btn btn-success mt-3" th:onclick="|location.href='@{/instructor/{lectureNumber}/taskUpdate/{taskNumber}(lectureNumber=${lectureNumber},taskNumber=${taskInfo.taskNumber})}'|">수정</button>
			<button type="button" class="btn btn-secondary mt-3" th:onclick="|location.href='@{/instructor/{lectureNumber}/taskList(lectureNumber=${taskInfo.lectureNumber})}'|">목록</button>
			<button type="button" class="btn btn-danger mt-3" th:onclick="confirmDelete(this)" th:data-task-no="${taskInfo.taskNumber}" th:data-lecture-no="${taskInfo.lectureNumber}">삭제</button>
      <button type="button" class="btn btn-info mt-3" th:onclick="|location.href='@{/instructor/{lectureNumber}/task/{taskNumber}/submittedStudents(lectureNumber=${lectureNumber},taskNumber=${taskInfo.taskNumber})}'|">제출상태</button>
        </div>
  	</div>
  	
  	<script>

  	function confirmDelete(button) {
  	    const swalWithBootstrapButtons = Swal.mixin({
  	        customClass: {
  	            confirmButton: "btn btn-success m-1",
  	            cancelButton: "btn btn-danger m-1",
  	            actions: 'my-actions',
  	            container: 'my-swal'
  	        },
  	        buttonsStyling: false
  	    });

  	    swalWithBootstrapButtons.fire({
  	        title: "정말로 삭제하시겠습니까?",
  	        text: "이 작업은 되돌릴 수 없습니다!",
  	        icon: "warning",
  	        showCancelButton: true,
  	        confirmButtonText: "네, 삭제합니다!",
  	        cancelButtonText: "아니요, 취소합니다!"
  	    }).then((result) => {
  	        if (result.isConfirmed) {
  	            // 삭제 작업 수행
  	            const taskNo = button.getAttribute('data-task-no');
  	            const lectureNo = button.getAttribute('data-lecture-no');
  	            location.href = `/lms/instructor/${lectureNo}/taskDelete?taskNo=${taskNo}`;
  	        } else if (result.dismiss === Swal.DismissReason.cancel) {
  	            swalWithBootstrapButtons.fire({
  	                title: "취소되었습니다",
  	                text: "파일이 안전하게 보관되었습니다.",
  	                icon: "error"
  	            });
  	        }
  	    });
  	}
</script>
  
</body>

</html>


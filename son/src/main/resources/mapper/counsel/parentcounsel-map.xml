<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.son.app.board.mapper.ParentCounselMapper">

	<!-- 학부모의 QNA 게시판 전체조회 -->
<!-- 	<select id="selectParentCounselAll" resultType="ParentCounselVO"> -->
<!-- 		SELECT -->
<!-- 		counsel_number ,  -->
<!-- 		title ,  -->
<!-- 		content ,  -->
<!-- 		write_date ,  -->
<!-- 		response_status , -->
<!-- 		response_content,  -->
<!-- 		lecture_number ,  -->
<!-- 		parent_number ,  -->
<!-- 		instructor_number -->
<!-- 		FROM -->
<!-- 		parent_counsel -->
<!-- 		ORDER BY counsel_number DESC -->
<!-- 	</select> -->
	<select id="selectParentCounselInfo" parameterType="int"
		resultType="ParentCounselVO">
		SELECT
		pc.counsel_number,
		pc.title,
		pc.content,
		pc.write_date,
		pc.response_status,
		pc.response_content,
		pc.lecture_number,
		pc.parent_number,
		pc.instructor_number,
		p.parent_name,
		s.student_name
		FROM
		parent_counsel pc
		LEFT JOIN
		parent p ON pc.parent_number = p.parent_number
		LEFT JOIN
		student s ON p.student_number = s.student_number
		WHERE
		pc.counsel_number = #{counsel_Number}
	</select>

    <insert id="insertParentCounsel" parameterType="ParentCounselVO">
        <selectKey keyProperty="counselNumber" resultType="int" order="BEFORE">
            SELECT NVL(MAX(counsel_number), 0) + 1 FROM parent_counsel
        </selectKey>
        INSERT INTO parent_counsel (
            counsel_number,
            title,
            content,
            write_date,
            response_status,
            response_content,
            lecture_number,
            parent_number,
            instructor_number,
            parent_name,
            student_name
        ) VALUES (
            #{counselNumber},
            #{title},
            #{content},
            #{writeDate},
            #{responseStatus},
            #{responseContent},
            #{lectureNumber},
            #{parentNumber},
            #{instructorNumber},
            #{parentName},
            #{studentName}
        )
    </insert>
</mapper>